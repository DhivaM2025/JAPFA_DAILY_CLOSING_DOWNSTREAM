(SELECT 'PURCHASE ORDER' AS CATEGORY, 
 	PO_PERIOD,
	COMPANY_CODE,
	PLANT,
	SUPPLYING_PLANT,
	VENDOR || '-' || VENDOR_NAME AS VENDOR,
    PURCHASE_ORDER,
    NULL AS GR_NUMBER,
    NULL AS INV_NUMBER,
    PURCHASE_TYPE AS TYPE,
	POSTING_DATE_PO AS PO_POSTING_DATE,
    NULL AS POSTING_DATE_GR,
    NULL AS POSTING_DATE_INV,
	UNIT,
	CURRENCY,
	SUM(PO_QUANTITY) AS PO_QTY,
	SUM(PO_AMOUNT) AS PO_AMOUNT,
	0 AS GR_QTY,
	0 AS GR_AMOUNT,
	0 AS INV_QTY,
	0 AS INV_AMOUNT
 FROM PROD_DB.DSTR_BI_COMMUNITY.F_SCM_PURCHASING_ORDER PO
 WHERE SOURCE_SYSTEM = 'PE1'
 AND PURCHASE_ORDER IN ('4150032900', '4150032804')
 GROUP BY ALL)
 UNION ALL
(SELECT 'GOODS RECEIPT' AS CATEGORY,
	PO_PERIOD,
	COMPANY_CODE,
	PLANT,
	SUPPLYING_PLANT,
	VENDOR || '-' || VENDOR_NAME AS VENDOR,
    PURCHASE_ORDER,
    DOCUMENT_NUMBER AS GR_NUMBER,
    NULL AS INV_NUMBER,
    PURCHASE_DOCUMENT_TYPE AS TYPE,
    NULL AS PO_POSTING_DATE,
    POSTING_DATE AS POSTING_DATE_GR,
    NULL AS POSTING_DATE_INV,
	UNIT,
	CURRENCY,
	0 AS PO_QTY,
	0 AS PO_AMOUNT,
	SUM(GR_QUANTITY) AS GR_QTY,
	SUM(GR_AMOUNT) AS GR_AMOUNT,
	0 AS INV_QTY,
	0 AS INV_AMOUNT
 FROM PROD_DB.DSTR_BI_COMMUNITY.F_SCM_PURCHASING_ORDER PO
 WHERE SOURCE_SYSTEM = 'PE1'
 AND PURCHASE_ORDER_ITEM_CATEGORY = 'E'
 AND PURCHASE_ORDER IN ('4150032900', '4150032804')
 GROUP BY ALL)
 UNION ALL
 (SELECT 'INVOICE RECEIPT' AS CATEGORY,
 	PO_PERIOD,
	COMPANY_CODE,
	PLANT,
	SUPPLYING_PLANT,
	VENDOR || '-' || VENDOR_NAME AS VENDOR,
    PURCHASE_ORDER,
    NULL AS GR_NUMBER,
    DOCUMENT_NUMBER AS INV_NUMBER,
    PURCHASE_DOCUMENT_TYPE AS TYPE,
	NULL AS PO_POSTING_DATE,
    NULL AS POSTING_DATE_GR,
    POSTING_DATE AS POSTING_DATE_INV,
	UNIT,
	CURRENCY,
	0 AS PO_QTY,
	0 AS PO_AMOUNT,
	0 AS GR_QTY,
	0 AS GR_AMOUNT,
	SUM(IR_QUANTITY) AS INV_QTY,
	SUM(IR_AMOUNT) AS INV_AMOUNT
 FROM PROD_DB.DSTR_BI_COMMUNITY.F_SCM_PURCHASING_ORDER PO
 WHERE SOURCE_SYSTEM = 'PE1'
 AND PURCHASE_ORDER_ITEM_CATEGORY = 'Q'
 AND PURCHASE_ORDER IN ('4150032900', '4150032804')
 GROUP BY ALL)
