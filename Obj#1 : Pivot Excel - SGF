-- PIVOT TRX NON INTERCO --
# Count SO Number
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[SO_NUMBER]);
    TRIM(Query1[SO_NUMBER]) <> ""
)

# Count SO Number yang DO Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[DO_NUMBER]);
    TRIM(Query1[DO_NUMBER]) <> ""
)

# Count SO Number yang GI Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> ""
)

# Count SO Number yang sudah konfirmasi POD
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
    Query1[POD_STATUS] = "C-Completely processed"
)

# Count SO Number yang Billing Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> ""
)

# Count SO Number yang TF/TG Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> ""
)

# Count SO Number yang Billing Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> "";
    NOT ISBLANK(Query1[BILL_CLEARING_NUMBER]);
    TRIM(Query1[BILL_CLEARING_NUMBER]) <> ""
)

-- PIVOT TRX INTERCO B2B&B2C --
# Count SO Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[SO_NUMBER]);
    TRIM(Query1[SO_NUMBER]) <> ""
)

# Count DO Customer
CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[DO_NUMBER]);
    TRIM(Query1[DO_NUMBER]) <> ""
)

# Count GI Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> ""
)

# Count POD Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
    (
        Query1[POD_STATUS] = "C-Completely processed"
        || ISBLANK(Query1[POD_STATUS])
        || TRIM(Query1[POD_STATUS]) <> ""
    )
)

# Count Billing Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    (
        Query1[POD_STATUS] = "C-Completely processed"
        || ISBLANK(Query1[POD_STATUS])
        || TRIM(Query1[POD_STATUS]) <> ""
    )
)

# Count TF/TG Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    (
        Query1[POD_STATUS] = "C-Completely processed"
        || ISBLANK(Query1[POD_STATUS])
        || TRIM(Query1[POD_STATUS]) <> ""
    );
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> ""
)

# Count Billing Clearing Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    Query1[POD_STATUS] = "C-Completely processed";
    (
        Query1[POD_STATUS] = "C-Completely processed"
        || ISBLANK(Query1[POD_STATUS])
        || TRIM(Query1[POD_STATUS]) <> ""
    );
    NOT ISBLANK(Query1[BILL_CLEARING_NUMBER]);
    TRIM(Query1[BILL_CLEARING_NUMBER]) <> ""
)
