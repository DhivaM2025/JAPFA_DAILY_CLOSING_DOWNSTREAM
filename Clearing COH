SELECT
    dffgbcs.*,
    CASE 
        WHEN dffgbcs.DOCUMENT_TYPE = 'AB'
            THEN DATEADD('day', 1, TO_DATE(dffgbcs.PAYMENT_DATE, 'YYYYMMDD'))
        WHEN DOCUMENT_TYPE IN ('SK', 'KZ')
            THEN DATEADD('day', -1, TO_DATE(dffgbcs.PAYMENT_DATE, 'YYYYMMDD'))
        ELSE TO_DATE(dffgbcs.PAYMENT_DATE, 'YYYYMMDD')
    END AS ACTUAL_PAYMENT_DATE,
    CASE
        WHEN PROFIT_CENTER IS NOT NULL AND PROFIT_CENTER_NAME <> '' 
            THEN LEFT(PROFIT_CENTER_NAME, 3)
        WHEN PROFIT_CENTER IS NOT NULL AND PROFIT_CENTER <> '' 
            THEN PROFIT_CENTER
        ELSE NULL
    END AS PROFIT_CENTER_LOKASI
FROM DEV_F_FINANCE_GL_BANK_CASH_SETTLEMENT dffgbcs
WHERE dffgbcs.GL_ACCOUNT IN ('1111203200', '1111903001')
  AND TO_DATE(dffgbcs.PAYMENT_DATE, 'YYYYMMDD')
      BETWEEN '2025-11-01' AND '2025-12-18'
  AND dffgbcs.DOCUMENT_TYPE IN ('SK', 'AB', 'KZ', 'KA');
