SELECT 
-- BASIC DATA --
	SO.COMPANY_CODE || '-' || CP.COMPANY_NAME AS COMPANY,
	SO.CUSTOMER,
	CUST.CUSTOMER_NAME AS CUSTOMER_SO_NAME,
	SO.CUSTOMER_SHIP_TO,
	CUSTSH.CUSTOMER_NAME AS CUSTOMER_SHIP_TO_NAME,
	SO.SALES_OFFICE || '-' || SA1.SALES_OFFICE_DESC AS SALES_OFFICE,
	SO.PLANT || '-' || CP1.PLANT_NAME AS PLANT,
	SO.DIVISION || '-' || SO.DIVISION_DESC AS DIVISION,
	SO.DISTRIBUTION_CHANNEL || '-' || SA.DISTRIBUTION_CHANNEL_DESC AS DISTRIBUTION_CHANNEL,
	CUST.REGION || '-' || DSR.REGION_DESCRIPTION AS REGION,
	CASE 
		WHEN DSR.REGION IN ('01', '02', '03', '04', '05', '28') THEN 'PULAU JAWA'
    	ELSE 'LUAR JAWA'
	END AS STATUS_REGION,
	CASE 
    	WHEN SB.TERM_OF_PAYMENT_DESC IS NULL OR SB.TERM_OF_PAYMENT = '' THEN SB.TERM_OF_PAYMENT
    	ELSE SB.TERM_OF_PAYMENT || '-' || SB.TERM_OF_PAYMENT_DESC
	END AS TOP,
	CPOD.POD_FLAG,
-- DOC TYPE --
	SO.SALES_ORDER_TYPE || '-' || SO.SALES_ORDER_TYPE_DESC AS SO_TYPE,
	SD_F.DELIVERY_TYPE || '-' || SD_F.DELIVERY_TYPE_DESC AS DO_TYPE,
	SB.BILLING_TYPE || '-' || SB.BILLING_TYPE_DESC AS BILLING_TYPE, 
	TF.TTF_DOC_TYPE AS TFTG_TYPE,
-- DOC STATUS --
	CASE 
    	WHEN SO.SALES_ORDER_STATUS IS NULL OR SO.SALES_ORDER_STATUS_DESC IS NULL THEN SO.SALES_ORDER_STATUS_DESC 
    	ELSE SO.SALES_ORDER_STATUS || '-' || SO.SALES_ORDER_STATUS_DESC 
	END AS SALES_ORDER_STATUS,
	SO.SALES_ORDER_STATUS_REJECTION || '-' || SO.SALES_ORDER_STATUS_REJECTION_DESC AS SALES_ORDER_STATUS_REJECTION,
    SO.SALES_ORDER_REASON_REJECTION_DESC,
	CASE
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(AJS/VSN) SO Batal' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CCP-ICP) SO Cancel Salah Input Customer' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CCP-ICP) SO Rejected' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CIOSHFPJFS) Cancel SO' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CIOSHFPJFS) Full Retur Surat Jalan' THEN 'Delivery Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CIOSHFPJFS) Selisih loading' THEN 'Delivery Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CIOSHFPJFS) Stock tidak ada' THEN 'Stock Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(CIOSHFPJFS) System Rejection' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = '(IJA) Cancel SO' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = 'Over kredit limit dan TOP' THEN 'AR Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = 'Pembatalan order dari customer' THEN 'Order Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = 'Pembayaran belum masuk' THEN 'AR Related'
	    WHEN SO.SALES_ORDER_REASON_REJECTION_DESC = 'Stok Kosong (Barang lagi di produksi)' THEN 'Stock Related'
	    ELSE 'N/A'
	END AS SALES_ORDER_REASON_REJECTION_GROUP,
	CASE 
  		WHEN SD_F.DELIVERY_STATUS = 'Not yet processed' THEN 'A-Not yet processed'
    	WHEN SD_F.DELIVERY_STATUS = 'Partially processed' THEN 'B-Partially processed'
    	WHEN SD_F.DELIVERY_STATUS = 'Completely processed' THEN 'C-Completely processed'
    ELSE SD_F.DELIVERY_STATUS
	END AS DELIVERY_ORDER_STATUS,
	CASE 
  		WHEN SD_C.DELIVERY_STATUS = 'Not yet processed' THEN 'A-Not yet processed'
    	WHEN SD_C.DELIVERY_STATUS = 'Partially processed' THEN 'B-Partially processed'
    	WHEN SD_C.DELIVERY_STATUS = 'Completely processed' THEN 'C-Completely processed'
    ELSE SD_C.DELIVERY_STATUS
	END AS DELIVERY_ORDER_CSG_STATUS,
	CASE 
  		WHEN SD_F.DELIVERY_POD_STATUS = 'Not yet processed' THEN 'A-Not yet processed'
    	WHEN SD_F.DELIVERY_POD_STATUS = 'Partially processed' THEN 'B-Partially processed'
    	WHEN SD_F.DELIVERY_POD_STATUS = 'Completely processed' THEN 'C-Completely processed'
    ELSE SD_F.DELIVERY_POD_STATUS
	END AS POD_STATUS,
	CASE 
  		WHEN SD_C.DELIVERY_POD_STATUS = 'Not yet processed' THEN 'A-Not yet processed'
    	WHEN SD_C.DELIVERY_POD_STATUS = 'Partially processed' THEN 'B-Partially processed'
    	WHEN SD_C.DELIVERY_POD_STATUS = 'Completely processed' THEN 'C-Completely processed'
    ELSE SD_C.DELIVERY_POD_STATUS
	END AS POD_CSG_STATUS,
	CASE
	    WHEN COALESCE(
	            COALESCE(DO_REASON.SALES_ORDER_REASON, DO_REASON_FRANCO.SALES_ORDER_REASON) || '-' || COALESCE(DO_REASON.SALES_ORDER_REASON_DESC, DO_REASON_FRANCO.SALES_ORDER_REASON_DESC), ''
	    ) = '' THEN FALSE
	    ELSE TRUE
	END AS DELIVERY_REJECTION_FLAG,
	COALESCE (DO_REASON.SALES_ORDER_REASON,DO_REASON_FRANCO.SALES_ORDER_REASON) || '-' || COALESCE (DO_REASON.SALES_ORDER_REASON_DESC,DO_REASON_FRANCO.SALES_ORDER_REASON_DESC) AS DELIVERY_REJECTION_REASON,
	CASE
	    WHEN
	        COALESCE(DO_REASON.SALES_ORDER_REASON,DO_REASON_FRANCO.SALES_ORDER_REASON) || '-' || COALESCE(DO_REASON.SALES_ORDER_REASON_DESC,DO_REASON_FRANCO.SALES_ORDER_REASON_DESC)
	        IN (
	            'K00-(CAS)Ret Cons',
	            'K03-(CAS)Ret Same Prd Qlty',
	            'K04-(CAS)Ret Same Prd Non Qlty',
	            'K12-(CAS)Ret Same Prd Adm'
	        )
	    THEN 'Order Related'
	    ELSE 'N/A'
	END AS DELIVERY_INTERCO_REJECTION_REASON_GROUPING,
	CASE 
    	WHEN SB.POSTING_STATUS IS NULL OR SB.POSTING_STATUS_DESCRIPTION IS NULL THEN SB.POSTING_STATUS_DESCRIPTION 
    	ELSE SB.POSTING_STATUS || '-' || SB.POSTING_STATUS_DESCRIPTION 
  	END AS BILLING_STATUS,
	CASE 
        WHEN SO.SALES_ORDER_TYPE = 'ZKS2' AND SO.CUSTOMER = 'JID90HA000' THEN 'Interco Automation MT'
        WHEN SO.SALES_ORDER_TYPE = 'ZKS2' AND SO.CUSTOMER = 'JID90HA001' THEN 'Interco Automation B2B'
        WHEN SO.SALES_ORDER_TYPE = 'ZKSA' AND SO.CUSTOMER = 'JID8700000' THEN 'Interco Automation B2B VAM'
        ELSE 'Non Interco'
	END AS CATEGORY,
-- DOC NUMBER --
	SO.CREATED_BY,
	F.SALES_ORDER_NUMBER AS SO_NUMBER,
	CASE 
    	WHEN SO.SALES_ORDER_TYPE = 'ZKS2' AND SO.CUSTOMER = 'JID90HA000' THEN SO.SALES_ORDER_EXTERNAL_DOCUMENT
        WHEN SO.SALES_ORDER_TYPE = 'ZKS2' AND SO.CUSTOMER = 'JID90HA001' THEN SO.SALES_ORDER_EXTERNAL_DOCUMENT
        WHEN SO.SALES_ORDER_TYPE = 'ZKSA' AND SO.CUSTOMER = 'JID8700000' THEN SO.SALES_ORDER_EXTERNAL_DOCUMENT
        ELSE SO.SALES_ORDER_EXTERNAL_DOCUMENT
    END AS SALES_ORDER_REFERENCE,
	F.SO_CSGMNT_NUMBER AS SO_CSGMNT_NUMBER,
	F.DO_CSGMNT_NUMBER AS DO_CSGMNT_NUMBER,
	F.DELIVERY_NUMBER AS DO_NUMBER,
	SCM_C.MATERIAL_DOCUMENT_NUMBER AS GI_CSGMNT_NUMBER,
	SCM_F.MATERIAL_DOCUMENT_NUMBER AS GI_NUMBER,
	SB.BILLING_NUMBER AS BILL_NUMBER,
  	TF.TTF_NUMBER AS TFTG_NUMBER,
  	SBC.BILLING_CLEARING_DOC AS BILL_CLEARING_NUMBER,
-- DATE --
	TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') AS SO_CREATED_DATE,
	TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') AS SO_DATE,
	TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') AS SO_CSG_CREATED_DATE,
	TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') AS SO_CSG_DATE,
	TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') AS DO_CREATED_DATE,
	TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') AS DO_ACTUAL_DATE,
	TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') AS DO_CSG_CREATED_DATE,
	TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') AS DO_CSG_ACTUAL_DATE,
	TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') AS GI_ENTRY_DATE,
	TRY_TO_DATE (SCM_F.POSTING_DATE, 'YYYYMMDD') AS GI_POSTING_DATE,
	TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') AS GI_CSG_ENTRY_DATE,
	TRY_TO_DATE (SCM_C.POSTING_DATE, 'YYYYMMDD') AS GI_CSG_POSTING_DATE,
	TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') AS POD_DATE,
	TRY_TO_DATE(SD_C.DELIVERY_POSTING_DATE, 'YYYYMMDD') AS POD_CSG_DATE,
	TRY_TO_DATE(PD.POD_DATE, 'YYYYMMDD') AS TVPOD_DATE,
	TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') AS BILLING_CREATED_DATE,
	TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') AS BILLING_DATE,
	TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') AS TFTG_CREATED_DATE,
	TRY_TO_DATE(TF.TTF_DOC_DATE, 'YYYYMMDD') AS TFTG_DOC_DATE,
	TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') AS TFTG_ACTUAL_DATE,
	TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') AS BILLING_CLEAR_CREATED_DATE,
	TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') AS BILLING_CLEAR_DATE,
 -- DATE SELISIH FOR AGING
	CASE 
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD'))) 	
	    WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))									
	    ELSE 'N/A'
	END AS SELISIH_SO_DO_CSGMNT,
	CASE 
	    WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_DO_CSGMNT_GI_CSGMNT,
	CASE 
	    WHEN TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_GI_CSGMNT_POD_CSGMNT,
	CASE 
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD'))) 	
	    WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))									
	    ELSE 'N/A'
	END AS SELISIH_SO_DO,
	CASE 
	    WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_DO_GI,
	CASE 
	    WHEN TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_GI_POD,
	CASE 
	    WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD'), TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_POD_BILLING,
	CASE 
	    WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_BILLING_TFTG,
	CASE 
	    WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_TFTG_BILLING_CLEAR,
	CASE 
	    WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD')))
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL 
	    THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_BILLING_BILLING_CLEAR,
-- TRANSAKSI COD --
	CASE  
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NULL THEN '0'
	    WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD'), TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD')))
	    WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_POSTING_DATE, 'YYYYMMDD'), CURRENT_DATE))
	    ELSE 'N/A'
	END AS SELISIH_POD_BILLING_CLEARING,
-- AGING PROCESS
	CASE
	    WHEN SELISIH_SO_DO_CSGMNT = 'N/A' THEN 'N/A'
	    WHEN SELISIH_SO_DO_CSGMNT = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_SO_DO_CSGMNT) > 30 THEN '8/ >30 Hari'
    ELSE ''
	END AS AGING_SO_DO_CSGMNT,
	CASE
	    WHEN SELISIH_DO_CSGMNT_GI_CSGMNT = 'N/A' THEN 'N/A'
	    WHEN SELISIH_DO_CSGMNT_GI_CSGMNT = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_DO_CSGMNT_GI_CSGMNT) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_DO_CSGMNT_GI_CSGMNT,
	CASE
	    WHEN SELISIH_GI_CSGMNT_POD_CSGMNT = 'N/A' THEN 'N/A'
	    WHEN SELISIH_GI_CSGMNT_POD_CSGMNT = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_GI_CSGMNT_POD_CSGMNT) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_GI_CSGMNT_POD_CSGMNT,
	CASE
	    WHEN SELISIH_SO_DO = 'N/A' THEN 'N/A'
	    WHEN SELISIH_SO_DO = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_SO_DO) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_SO_DO) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_SO_DO) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_SO_DO) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_SO_DO) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_SO_DO) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_SO_DO) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_SO_DO,
	CASE
	    WHEN SELISIH_DO_GI = 'N/A' THEN 'N/A'
	    WHEN SELISIH_DO_GI = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_DO_GI) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_DO_GI) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_DO_GI) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_DO_GI) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_DO_GI) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_DO_GI) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_DO_GI) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_DO_GI,
	CASE
	    WHEN SELISIH_GI_POD = 'N/A' THEN 'N/A'
	    WHEN SELISIH_GI_POD = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_GI_POD) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_GI_POD) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_GI_POD) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_GI_POD) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_GI_POD) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_GI_POD) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_GI_POD) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_GI_POD,
	CASE
	    WHEN SELISIH_POD_BILLING = 'N/A' THEN 'N/A'
	    WHEN SELISIH_POD_BILLING = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_POD_BILLING) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_POD_BILLING) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_POD_BILLING,
	CASE
	    WHEN SELISIH_BILLING_TFTG = 'N/A' THEN 'N/A'
	    WHEN SELISIH_BILLING_TFTG = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_BILLING_TFTG) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_BILLING_TFTG) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_BILLING_TFTG,
	CASE
	    WHEN SELISIH_TFTG_BILLING_CLEAR = 'N/A' THEN 'N/A'
	    WHEN SELISIH_TFTG_BILLING_CLEAR = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_TFTG_BILLING_CLEAR) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_TFTG_BILLING_CLEAR,
	CASE
	    WHEN SELISIH_BILLING_BILLING_CLEAR = 'N/A' THEN 'N/A'
	    WHEN SELISIH_BILLING_BILLING_CLEAR = 0 THEN '1/ Hari - H'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_BILLING_BILLING_CLEAR) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_BILLING_BILLING_CLEAR,
-- TRANSAKSI COD --
	CASE
	    WHEN SELISIH_POD_BILLING_CLEARING = 'N/A' THEN 'N/A'
	    WHEN SELISIH_POD_BILLING_CLEARING = 0 THEN '1/ Hari-H'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) = 1 THEN '2/ 1 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) = 2 THEN '3/ 2 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) = 3 THEN '4/ 3 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) BETWEEN 4 AND 7 THEN '5/ 4-7 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) BETWEEN 8 AND 14 THEN '6/ 7-14 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) BETWEEN 15 AND 30 THEN '7/ 14-30 Hari'
	    WHEN ABS(SELISIH_POD_BILLING_CLEARING) > 30 THEN '8/ >30 Hari'
	    ELSE ''
	END AS AGING_POD_BILLING_CLEARING,
-- BACKDATE (Y/N)
	CASE 
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') > TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') < TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS SO_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') > TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') < TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS SO_CSGMNT_BACKDATE,
	CASE  
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') > TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') < TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS DO_CSGMT_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE , 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE , 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE , 'YYYYMMDD') = TRY_TO_DATE(SCM_C.POSTING_DATE , 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') > TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') < TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS GI_CSGMT_BACKDATE,
	CASE  
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') > TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') < TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS DO_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE , 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE , 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE , 'YYYYMMDD') = TRY_TO_DATE(SCM_F.POSTING_DATE , 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') > TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') < TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS GI_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') > TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') < TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS BILLING_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') > TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') < TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS TFTG_BACKDATE,
	CASE 
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') IS NULL THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') = TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') THEN 'Real-time entry'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') > TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') THEN 'Forward-dated entry'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') < TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') THEN 'Backdated entry'
		ELSE 'Backdated entry'
	END AS BILLING_CLEARING_BACKDATE,
	-- BACKDATE CREATED DATE - DOC DATE
	CASE 
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD') IS NOT NULL 
		THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SO.SALES_ORDER_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS SO_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SOCSG.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD') IS NOT NULL 
		THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SOCSG.SALES_ORDER_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS SO_CSGMNT_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_C.DELIVERY_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_C.DELIVERY_ACTUAL_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS DO_CSGMNT_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_C.ENTRY_DATE, 'YYYYMMDD'), TRY_TO_DATE(SCM_C.POSTING_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS GI_CSGMNT_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SD_F.DELIVERY_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SD_F.DELIVERY_ACTUAL_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS DO_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SCM_F.ENTRY_DATE, 'YYYYMMDD'), TRY_TO_DATE(SCM_F.POSTING_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS GI_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SB.BILLING_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SB.BILLING_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS BILLING_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(TF.TTF_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(TF.TTF_ACTUAL_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS TFTG_DIFF_DAYS,
	CASE 
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NULL AND TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') IS NULL THEN 'N/A'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') IS NULL THEN '0'
		WHEN TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD') IS NOT NULL AND TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD') IS NOT NULL THEN TO_VARCHAR(DATEDIFF(DAY, TRY_TO_DATE(SBC.BILLING_CLEAR_CREATED_DATE, 'YYYYMMDD'), TRY_TO_DATE(SBC.BILLING_CLEAR_DATE, 'YYYYMMDD')))
		ELSE 'N/A'
	END AS BILLING_CLEARING_DIFF_DAYS,
	-- AGING BACKDATE DATA
	CASE
		WHEN SO_DIFF_DAYS = 'N/A' THEN 'N/A'
		WHEN SO_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
		WHEN SO_DIFF_DAYS < 0 AND SO_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
		WHEN SO_DIFF_DAYS < -3 AND SO_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
		WHEN SO_DIFF_DAYS < -7 AND SO_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
		WHEN SO_DIFF_DAYS < -14 AND SO_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
		WHEN SO_DIFF_DAYS < -30 THEN '6/ >30 Hari'
		ELSE ''
	END AS AGING_SO_DIFF_DAYS,
	CASE
	    WHEN SO_CSGMNT_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN SO_CSGMNT_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN SO_CSGMNT_DIFF_DAYS < 0 AND SO_CSGMNT_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN SO_CSGMNT_DIFF_DAYS < -3 AND SO_CSGMNT_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN SO_CSGMNT_DIFF_DAYS < -7 AND SO_CSGMNT_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN SO_CSGMNT_DIFF_DAYS < -14 AND SO_CSGMNT_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN SO_CSGMNT_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_SO_CSGMNT_DIFF_DAYS,
	CASE
	    WHEN DO_CSGMNT_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN DO_CSGMNT_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN DO_CSGMNT_DIFF_DAYS < 0 AND DO_CSGMNT_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN DO_CSGMNT_DIFF_DAYS < -3 AND DO_CSGMNT_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN DO_CSGMNT_DIFF_DAYS < -7 AND DO_CSGMNT_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN DO_CSGMNT_DIFF_DAYS < -14 AND DO_CSGMNT_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN DO_CSGMNT_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_DO_CSGMNT_DIFF_DAYS,
	CASE
	    WHEN GI_CSGMNT_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN GI_CSGMNT_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN GI_CSGMNT_DIFF_DAYS < 0 AND GI_CSGMNT_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN GI_CSGMNT_DIFF_DAYS < -3 AND GI_CSGMNT_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN GI_CSGMNT_DIFF_DAYS < -7 AND GI_CSGMNT_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN GI_CSGMNT_DIFF_DAYS < -14 AND GI_CSGMNT_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN GI_CSGMNT_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_GI_CSGMNT_DIFF_DAYS,
	CASE
	    WHEN DO_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN DO_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN DO_DIFF_DAYS < 0 AND DO_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN DO_DIFF_DAYS < -3 AND DO_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN DO_DIFF_DAYS < -7 AND DO_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN DO_DIFF_DAYS < -14 AND DO_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN DO_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_DO_DIFF_DAYS,
	CASE
	    WHEN GI_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN GI_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN GI_DIFF_DAYS < 0 AND GI_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN GI_DIFF_DAYS < -3 AND GI_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN GI_DIFF_DAYS < -7 AND GI_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN GI_DIFF_DAYS < -14 AND GI_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN GI_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_GI_DIFF_DAYS,
	CASE
	    WHEN BILLING_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN BILLING_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN BILLING_DIFF_DAYS < 0 AND BILLING_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN BILLING_DIFF_DAYS < -3 AND BILLING_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN BILLING_DIFF_DAYS < -7 AND BILLING_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN BILLING_DIFF_DAYS < -14 AND BILLING_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN BILLING_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_BILLING_DIFF_DAYS,
	CASE
	    WHEN TFTG_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN TFTG_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN TFTG_DIFF_DAYS < 0 AND TFTG_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN TFTG_DIFF_DAYS < -3 AND TFTG_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN TFTG_DIFF_DAYS < -7 AND TFTG_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN TFTG_DIFF_DAYS < -14 AND TFTG_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN TFTG_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_TFTG_DIFF_DAYS,
	CASE
	    WHEN BILLING_CLEARING_DIFF_DAYS = 'N/A' THEN 'N/A'
	    WHEN BILLING_CLEARING_DIFF_DAYS >= 0 THEN '1/ 0 Hari'
	    WHEN BILLING_CLEARING_DIFF_DAYS < 0 AND BILLING_CLEARING_DIFF_DAYS >= -3 THEN '2/ 1-3 Hari'
	    WHEN BILLING_CLEARING_DIFF_DAYS < -3 AND BILLING_CLEARING_DIFF_DAYS >= -7 THEN '3/ 3-7 Hari'
	    WHEN BILLING_CLEARING_DIFF_DAYS < -7 AND BILLING_CLEARING_DIFF_DAYS >= -14 THEN '4/ 7-14 Hari'
	    WHEN BILLING_CLEARING_DIFF_DAYS < -14 AND BILLING_CLEARING_DIFF_DAYS >= -30 THEN '5/ 14-30 Hari'
	    WHEN BILLING_CLEARING_DIFF_DAYS < -30 THEN '6/ >30 Hari'
	    ELSE ''
	END AS AGING_BILLING_CLEARING_DIFF_DAYS
FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_FLOW_ORDER_DOCUMENT_FLOW F
LEFT JOIN PROD_DB.DSTR_BI_COMMUNITY.F_SALES_SALES_ORDER SO
	ON SO.SOURCE_SYSTEM = F.SOURCE_SYSTEM
    AND SO.SALES_ORDER_NUMBER = F.SALES_ORDER_NUMBER
	/*AND SO.SALES_ORDER_STATUS_REJECTION <> 'C'*/
	AND SO.SALES_ORDER_TYPE NOT IN ('ZKC1','ZKC2','ZKC3','ZKC4','ZKC5','ZKD1','ZKD2','ZKQ1','ZKR1','ZKR2','ZKR5','ZKR6','ZKR8','ZKR9','ZKRA','ZKRB','ZKRC','ZKS5','ZKS7','ZKS8')
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,SALES_ORDER_NUMBER,SALES_ORDER_TYPE,SALES_ORDER_STATUS,SALES_ORDER_STATUS_DESC,SALES_ORDER_STATUS_REJECTION,SALES_ORDER_STATUS_REJECTION_DESC,SALES_ORDER_CREATED_DATE,SALES_ORDER_DATE,SALES_ORDER_REASON_REJECTION_DESC FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_SALES_ORDER) SOCSG
	ON SOCSG.SOURCE_SYSTEM = F.SOURCE_SYSTEM
    AND SOCSG.SALES_ORDER_NUMBER = F.SO_CSGMNT_NUMBER
	AND SOCSG.SALES_ORDER_TYPE NOT IN ('ZKC1','ZKC2','ZKC3','ZKC4','ZKC5','ZKD1','ZKD2','ZKQ1','ZKR1','ZKR2','ZKR5','ZKR6','ZKR8','ZKR9','ZKRA','ZKRB','ZKRC','ZKS5','ZKS7','ZKS8')
LEFT JOIN 
	(SELECT DISTINCT SALES_ORDER_EXTERNAL_DOCUMENT, SALES_ORDER_NUMBER, SALES_ORDER_TYPE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_SALES_ORDER) SO1
    ON SO1.SALES_ORDER_EXTERNAL_DOCUMENT = SO.SALES_ORDER_NUMBER
    AND SO1.SALES_ORDER_TYPE NOT IN ('ZKS3','ZKSC', 'ZKR3', 'ZKRC', 'ZKD3', 'ZKDC')
LEFT JOIN (
	SELECT DISTINCT DO.SOURCE_SYSTEM, DELIVERY_NUMBER,REFERENCE_SALES_ORDER_NUMBER, SO.REFERENCE_DOCUMENT_NUMBER,  DO.SALES_ORDER_REASON, DO.SALES_ORDER_REASON_DESC 
	FROM F_SALES_DELIVERY DO
	LEFT JOIN F_SALES_SALES_ORDER SO ON DO.REFERENCE_SALES_ORDER_NUMBER = SO.SALES_ORDER_NUMBER AND DO.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
	WHERE DO.SOURCE_SYSTEM = 'PE2' AND DO.SALES_ORDER_REASON IS NOT NULL
	) DO_REASON 
		ON F.SALES_ORDER_NUMBER = DO_REASON.REFERENCE_DOCUMENT_NUMBER AND F.SOURCE_SYSTEM = DO_REASON.SOURCE_SYSTEM
LEFT JOIN (
	SELECT DISTINCT DO.SOURCE_SYSTEM, DELIVERY_NUMBER,REFERENCE_SALES_ORDER_NUMBER, SO.REFERENCE_DOCUMENT_NUMBER,  DO.SALES_ORDER_REASON, DO.SALES_ORDER_REASON_DESC 
	FROM F_SALES_DELIVERY DO
	LEFT JOIN F_SALES_SALES_ORDER SO ON DO.REFERENCE_SALES_ORDER_NUMBER = SO.SALES_ORDER_NUMBER AND DO.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
	WHERE DO.SOURCE_SYSTEM = 'PE2' AND DO.SALES_ORDER_REASON IS NOT NULL
	) DO_REASON_FRANCO 
	ON F.SO_CSGMNT_NUMBER = DO_REASON_FRANCO.REFERENCE_DOCUMENT_NUMBER AND F.SOURCE_SYSTEM = DO_REASON_FRANCO.SOURCE_SYSTEM
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,DELIVERY_NUMBER,DELIVERY_TYPE,DELIVERY_TYPE_DESC,DELIVERY_STATUS,DELIVERY_POD_STATUS,DELIVERY_POSTING_DATE,DELIVERY_CREATED_DATE,DELIVERY_ACTUAL_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_DELIVERY) SD_F
	ON SD_F.SOURCE_SYSTEM = F.SOURCE_SYSTEM
	AND SD_F.DELIVERY_NUMBER = F.DELIVERY_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,DELIVERY_NUMBER,DELIVERY_TYPE,DELIVERY_TYPE_DESC,DELIVERY_STATUS,DELIVERY_POD_STATUS,DELIVERY_POSTING_DATE,DELIVERY_CREATED_DATE,DELIVERY_ACTUAL_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_DELIVERY) SD_C
	ON SD_C.SOURCE_SYSTEM = F.SOURCE_SYSTEM
	AND SD_C.DELIVERY_NUMBER = F.DO_CSGMNT_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,"REFERENCE",MATERIAL_DOCUMENT_NUMBER,ENTRY_DATE,POSTING_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SCM_STOCK_TRANSACTION_SAP) SCM_F
    ON SCM_F.SOURCE_SYSTEM = F.SOURCE_SYSTEM
    AND SCM_F."REFERENCE" = F.DELIVERY_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,"REFERENCE",MATERIAL_DOCUMENT_NUMBER,ENTRY_DATE,POSTING_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SCM_STOCK_TRANSACTION_SAP) SCM_C
    ON SCM_C.SOURCE_SYSTEM = F.SOURCE_SYSTEM
    AND SCM_C."REFERENCE" = F.DO_CSGMNT_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,DELIVERY_NUMBER,POD_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_DELIVERY_POD) PD
    ON PD.SOURCE_SYSTEM = SD_F.SOURCE_SYSTEM
    AND PD.DELIVERY_NUMBER = SD_F.DELIVERY_NUMBER
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, CUSTOMER, POD_FLAG FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_CUSTOMER) CPOD
	ON CPOD.SOURCE_SYSTEM = SO.SOURCE_SYSTEM 
	AND CPOD.CUSTOMER = SO.CUSTOMER
LEFT JOIN (SELECT SOURCE_SYSTEM,REFERENCE_SALES_ORDER_NUMBER,BILLING_TYPE,BILLING_TYPE_DESC,POSTING_STATUS,POSTING_STATUS_DESCRIPTION,BILLING_NUMBER,BILLING_CREATED_DATE,BILLING_DATE,TERM_OF_PAYMENT,TERM_OF_PAYMENT_DESC
    FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_BILLING /*WHERE BILLING_TYPE NOT IN ('ZKR7','ZKR5','ZKD3','ZKX3','ZKX2','ZKX7','ZKC9','ZKX9','ZKX5','ZKR2','ZKS1','ZKX1','ZKC1','ZKX6','ZKS4','ZKR1','ZKX4','ZKXJ','ZKC2','ZKRA','ZKS2','ZKD1','ZKX8')*/
    GROUP BY SOURCE_SYSTEM,REFERENCE_SALES_ORDER_NUMBER,BILLING_TYPE,BILLING_TYPE_DESC,POSTING_STATUS,POSTING_STATUS_DESCRIPTION,BILLING_NUMBER,BILLING_CREATED_DATE,BILLING_DATE,TERM_OF_PAYMENT,TERM_OF_PAYMENT_DESC) SB
    ON SB.SOURCE_SYSTEM = SO.SOURCE_SYSTEM 
    AND SB.REFERENCE_SALES_ORDER_NUMBER = SO.SALES_ORDER_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,BILLING_NUMBER,TTF_DOC_TYPE,TTF_NUMBER,TTF_DOC_DATE,TTF_CREATED_DATE,TTF_ACTUAL_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_BILLING_TTF) TF
    ON TF.SOURCE_SYSTEM = SB.SOURCE_SYSTEM 
    AND TF.BILLING_NUMBER = SB.BILLING_NUMBER
LEFT JOIN 
	(SELECT DISTINCT SOURCE_SYSTEM,BILLING_NUMBER,BILLING_CLEARING_DOC,BILLING_CLEAR_DATE,BILLING_CLEAR_CREATED_DATE FROM PROD_DB.DSTR_BI_COMMUNITY.F_SALES_BILLING_CLEARING) SBC
    ON SBC.SOURCE_SYSTEM = SB.SOURCE_SYSTEM
    AND SBC.BILLING_NUMBER = SB.BILLING_NUMBER
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, CUSTOMER, CUSTOMER_NAME, REGION FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_CUSTOMER) CUST
    ON CUST.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
    AND CUST.CUSTOMER = SO.CUSTOMER
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, CUSTOMER, CUSTOMER_NAME FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_CUSTOMER) CUSTSH
    ON CUSTSH.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
    AND CUSTSH.CUSTOMER = SO.CUSTOMER_SHIP_TO
LEFT JOIN (SELECT SOURCE_SYSTEM, COMPANY_CODE, COMPANY_NAME FROM PROD_DB.DSTR_BI_COMMUNITY.D_SCM_COMPANY_AND_PLANT) CP
    ON CP.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
    AND CP.COMPANY_CODE = SO.COMPANY_CODE
LEFT JOIN (SELECT SOURCE_SYSTEM, PLANT, PLANT_NAME FROM PROD_DB.DSTR_BI_COMMUNITY.D_SCM_COMPANY_AND_PLANT) CP1
    ON CP1.SOURCE_SYSTEM = SO.SOURCE_SYSTEM
    AND CP1.PLANT = SO.PLANT
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, DISTRIBUTION_CHANNEL, DISTRIBUTION_CHANNEL_DESC FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_AREA) SA
    ON SA.SOURCE_SYSTEM = SO.SOURCE_SYSTEM 
    AND SA.DISTRIBUTION_CHANNEL = SO.DISTRIBUTION_CHANNEL
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, SALES_OFFICE, SALES_OFFICE_DESC FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_AREA) SA1
    ON SA1.SOURCE_SYSTEM = SO.SOURCE_SYSTEM 
    AND SA1.SALES_OFFICE = SO.SALES_OFFICE
LEFT JOIN (SELECT DISTINCT SOURCE_SYSTEM, REGION, REGION_DESCRIPTION FROM PROD_DB.DSTR_BI_COMMUNITY.D_SALES_REGION) DSR
    ON DSR.SOURCE_SYSTEM = CUST.SOURCE_SYSTEM
    AND DSR.REGION = CUST.REGION
WHERE SO.SOURCE_SYSTEM = 'PE2'
	AND SO.COMPANY_CODE = 'ID7A'
	AND SO.SALES_ORDER_TYPE NOT IN ('ZKC1','ZKC2','ZKC3','ZKC4','ZKC5','ZKD1','ZKD2','ZKQ1','ZKR1','ZKR2','ZKR5','ZKR6','ZKR8','ZKR9','ZKRA','ZKRB','ZKRC','ZKS5','ZKS7','ZKS8')
	AND TRY_TO_DATE(SO.SALES_ORDER_CREATED_DATE, 'YYYYMMDD') BETWEEN '2025-12-01' AND CURRENT_DATE
GROUP BY
    SO.COMPANY_CODE, CP.COMPANY_NAME,SO.PLANT, CP1.PLANT_NAME,F.SALES_ORDER_NUMBER,F.SO_CSGMNT_NUMBER,F.DO_CSGMNT_NUMBER,F.DELIVERY_NUMBER,
    SCM_C.MATERIAL_DOCUMENT_NUMBER,SCM_F.MATERIAL_DOCUMENT_NUMBER,SO.SALES_OFFICE,SA1.SALES_OFFICE_DESC,
    SO.CUSTOMER, CUST.CUSTOMER_NAME,SO.CUSTOMER_SHIP_TO, CUSTSH.CUSTOMER_NAME,
    SO.DIVISION, SO.DIVISION_DESC,SO.DISTRIBUTION_CHANNEL, SA.DISTRIBUTION_CHANNEL_DESC,
    CUST.REGION, DSR.REGION_DESCRIPTION,SB.TERM_OF_PAYMENT, SB.TERM_OF_PAYMENT_DESC,CPOD.POD_FLAG,
    SO.SALES_ORDER_TYPE, SO.SALES_ORDER_TYPE_DESC,SD_F.DELIVERY_TYPE, SD_F.DELIVERY_TYPE_DESC,
    SB.BILLING_TYPE, SB.BILLING_TYPE_DESC,TF.TTF_DOC_TYPE,SO.SALES_ORDER_STATUS, SO.SALES_ORDER_STATUS_DESC,
    SO.SALES_ORDER_STATUS_REJECTION, SO.SALES_ORDER_STATUS_REJECTION_DESC,SOCSG.SALES_ORDER_STATUS_REJECTION,
    SOCSG.SALES_ORDER_STATUS,SOCSG.SALES_ORDER_STATUS_DESC,SOCSG.SALES_ORDER_STATUS_REJECTION_DESC,
    SD_F.DELIVERY_STATUS,SD_F.DELIVERY_POD_STATUS,SD_C.DELIVERY_STATUS,SD_C.DELIVERY_POD_STATUS,
    SB.POSTING_STATUS, SB.POSTING_STATUS_DESCRIPTION,SD_C.DELIVERY_POSTING_DATE,
    SO.CUSTOMER, SO.SALES_ORDER_TYPE, SO.PLANT, SO.DIVISION,
    SO.CREATED_BY,SO.SALES_ORDER_NUMBER,SO1.SALES_ORDER_NUMBER,SO.SALES_ORDER_EXTERNAL_DOCUMENT,
    SD_F.DELIVERY_NUMBER,SB.BILLING_NUMBER,TF.TTF_NUMBER,SBC.BILLING_CLEARING_DOC,
    SO.SALES_ORDER_CREATED_DATE,SO.SALES_ORDER_DATE,SD_F.DELIVERY_CREATED_DATE,SD_F.DELIVERY_ACTUAL_DATE,
    SD_F.DELIVERY_POSTING_DATE,PD.POD_DATE,SOCSG.SALES_ORDER_CREATED_DATE,SOCSG.SALES_ORDER_DATE,
    SD_C.DELIVERY_CREATED_DATE,SD_C.DELIVERY_ACTUAL_DATE,SCM_F.ENTRY_DATE,SCM_F.POSTING_DATE,
    SCM_C.ENTRY_DATE,SCM_C.POSTING_DATE,DO_REASON.SALES_ORDER_REASON_DESC,DO_REASON_FRANCO.SALES_ORDER_REASON_DESC,
    SB.BILLING_CREATED_DATE,SB.BILLING_DATE,TF.TTF_CREATED_DATE,DO_REASON.SALES_ORDER_REASON,DO_REASON_FRANCO.SALES_ORDER_REASON,
    TF.TTF_DOC_DATE,SBC.BILLING_CLEAR_CREATED_DATE,SBC.BILLING_CLEAR_DATE,DSR.REGION,SO.SALES_ORDER_REASON_REJECTION_DESC,
	SOCSG.SALES_ORDER_REASON_REJECTION_DESC,TF.TTF_ACTUAL_DATE;
