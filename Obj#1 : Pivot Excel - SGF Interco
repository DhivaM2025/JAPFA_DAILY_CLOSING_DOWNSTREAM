# INTERCO MT - SALES DOC FLOW
# Count SO Number
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[SO_NUMBER]);
    TRIM(Query1[SO_NUMBER]) <> ""
)

# Count SO Number yang DO Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[DO_NUMBER]);
    TRIM(Query1[DO_NUMBER]) <> ""
)

# Count SO Number yang GI Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> ""
)

# Count SO Number yang sudah konfirmasi POD
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
    Query1[POD_STATUS] = "C-Completely processed"
)

# Count SO Number yang Billing Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    Query1[AMOUNT_ZERO_FLAG] = FALSE
)

# Count SO Number yang TF/TG Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> ""
)

# Count SO Number yang Billing Number Not Blank
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> "";
    NOT ISBLANK(Query1[BILL_CLEARING_NUMBER]);
    TRIM(Query1[BILL_CLEARING_NUMBER]) <> ""
)

# INTERCO MT - DELTA DATA
# Delta SO SGF to SO External Doc (SO CPP)
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    NOT ISBLANK(Query1[SO_NUMBER]);
    TRIM(Query1[SO_NUMBER]) <> "";
    (
        ISBLANK(Query1[SALES_ORDER_REFERENCE]) 
        || TRIM(Query1[SALES_ORDER_REFERENCE]) = ""
    )
)

# Delta SO to DO
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ( ISBLANK(Query1[DO_NUMBER]) || TRIM(Query1[DO_NUMBER]) = "" );
    ( NOT ISBLANK(Query1[SO_NUMBER]) && TRIM(Query1[SO_NUMBER]) <> "" )
)

# Delta DO to GI
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ( NOT ISBLANK(Query1[SO_NUMBER]) && TRIM(Query1[SO_NUMBER]) <> "" );
    ( NOT ISBLANK(Query1[DO_NUMBER]) || TRIM(Query1[DO_NUMBER]) <> "" );    
    ( ISBLANK(Query1[GI_NUMBER]) || TRIM(Query1[GI_NUMBER]) = "" )
)

# Delta GI to POD
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
        (
        ISBLANK(Query1[POD_STATUS])
        || TRIM(Query1[POD_STATUS]) = ""
        || Query1[POD_STATUS] = "A-Not yet processed"
    )
)

# Delta POD to Billing
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    NOT ISBLANK(Query1[GI_NUMBER]);
    TRIM(Query1[GI_NUMBER]) <> "";
    Query1[POD_STATUS] = "C-Completely processed";
    ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) = ""
)

# Delta Billing to TF/TG
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    Query1[POD_STATUS] = "C-Completely processed";
    ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) = ""
)

# Delta Billing to Billing Clearing
=CALCULATE(
    DISTINCTCOUNT(Query1[SO_NUMBER]);
    ISBLANK(Query1[REASON_POD]) || TRIM(Query1[REASON_POD]) = "";
    Query1[POD_STATUS] = "C-Completely processed";
    NOT ISBLANK(Query1[BILL_NUMBER]);
    TRIM(Query1[BILL_NUMBER]) <> "";
    NOT ISBLANK(Query1[TFTG_NUMBER]);
    TRIM(Query1[TFTG_NUMBER]) <> "";
    ISBLANK(Query1[BILL_CLEARING_NUMBER]);
    TRIM(Query1[BILL_CLEARING_NUMBER]) = ""
)
