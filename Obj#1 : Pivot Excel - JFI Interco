-- PIVOT TRX JFI INTERCO --
# Count SO Number Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER])
)

# Count SO Interco
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO])
)

# Count DO Cons
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER])
)

# Count GI Cons
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER])
)

# Count POD Interco
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE()
)

# Count Billing Interco
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE();
   NOT ISBLANK(Query1[BILLING_NUMBER_INTERCO])
)

# Count Billing Customer
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE();
   NOT ISBLANK(Query1[BILLING_NUMBER_INTERCO]);
   NOT ISBLANK(Query1[BILLING_NUMBER])
)

# Count Tukar Faktur
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE();
   NOT ISBLANK(Query1[BILLING_NUMBER_INTERCO]);
   NOT ISBLANK(Query1[BILLING_NUMBER]);
   Query1[TTF_DOC_TYPE] = "TF";
   NOT ISBLANK(Query1[TTF_NUMBER])
)

# Count Billing Clearing
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE();
   NOT ISBLANK(Query1[BILLING_NUMBER_INTERCO]);
   NOT ISBLANK(Query1[BILLING_NUMBER]);
   Query1[TTF_DOC_TYPE] = "TF";
   NOT ISBLANK(Query1[TTF_NUMBER]);
   NOT ISBLANK(Query1[BILLING_CLEARING_DOC])
)

# Count Invoice Receipt
=CALCULATE(
    DISTINCTCOUNT(Query1[SALES_ORDER_NUMBER]);
    NOT ISBLANK(Query1[SALES_ORDER_NUMBER_INTERCO]);
    NOT ISBLANK(Query1[DELIVERY_CONS_NUMBER]);
    NOT ISBLANK(Query1[GI_CONS_NUMBER]);
   Query1[DELIVERY_INTERCO_POD_STATUS] = "C-Completely processed";
   Query1[DELIVERY_INTERCO_REJECTION_FLAG] = FALSE();
   NOT ISBLANK(Query1[BILLING_NUMBER_INTERCO]);
   NOT ISBLANK(Query1[INVOICE_NUMBER])
)
