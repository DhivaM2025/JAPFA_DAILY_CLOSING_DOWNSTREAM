-- NOT USED --
-- Dashboard monitor perpindahan stock antar plant
SELECT DISTINCT
    A.PURCHASE_ORDER,
    A."REFERENCE",
    A.MVT_PENGIRIM,
    B.MVT_PENERIMA,
    A.LOKASI_PENGIRIM,
    B.LOKASI_PENERIMA,
    A.SLOC_PENGIRIM,
    B.SLOC_PENERIMA,
    A.MUTASI_OUT_QTY,
    A.MUTASI_OUT_AMOUNT,
    B.MUTASI_IN_QTY,
    B.MUTASI_IN_AMOUNT
FROM
(SELECT 
 	PURCHASE_ORDER,
    "REFERENCE",
    MOVEMENT_TYPE || '-' || MOVEMENT_TYPE_DESCRIPTION AS MVT_PENGIRIM,    
    FROM_LOCATION AS LOKASI_PENGIRIM,
    STORAGE_LOCATION || '-' || STORAGE_LOCATION_NAME AS SLOC_PENGIRIM,
    SUM(MUTASI_OUT_QUANTITY) AS MUTASI_OUT_QTY,
    SUM(MUTASI_OUT_AMOUNT) AS MUTASI_OUT_AMOUNT
 FROM /*PROD_DB.DSTR_BI_COMMUNITY.F_SCM_MUTASI_MATERIAL*/ TEMP_SCM_MUTASI
 WHERE MOVEMENT_TYPE = '641'
      AND "REFERENCE" = '4202651496'
 GROUP BY ALL) A,
(SELECT 
	PURCHASE_ORDER,
    "REFERENCE",
    MOVEMENT_TYPE || '-' || MOVEMENT_TYPE_DESCRIPTION AS MVT_PENERIMA,
    TO_LOCATION AS LOKASI_PENERIMA,
    STORAGE_LOCATION || '-' || STORAGE_LOCATION_NAME AS SLOC_PENERIMA,
    SUM(MUTASI_IN_QUANTITY) AS MUTASI_IN_QTY,
    SUM(MUTASI_IN_AMOUNT) AS MUTASI_IN_AMOUNT
 FROM /*PROD_DB.DSTR_BI_COMMUNITY.F_SCM_MUTASI_MATERIAL*/ TEMP_SCM_MUTASI
 WHERE MOVEMENT_TYPE = '101'
 	AND "REFERENCE" = '4202651496'
 GROUP BY ALL) B;
